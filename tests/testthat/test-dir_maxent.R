library(testthat)
shares <- c(i01.b = 0.000684264991660737, i01.c = 0.000516544213909967,
            i01.d = 0.00250804152947034, i01.e = 0.00104395588051281, i01.f = 0.000114648843168066,
            i01.h = 3.30495742107112e-05, i01.i = 0.000544948101280177, i01.j = 0.000286622521818285,
            i01.k = 0.000386590436155406, i01.n = 0.000773877974393887, i02 = 0.00216961768398566,
            i05 = 0.000110414974187145, i10 = 3.74569210478189e-05, i11.a = 1.68207462448187e-06,
            i11.b = 8.1533115851427e-06, i12 = 1.39340725532119e-06, i13.1 = 1.74922748719031e-06,
            i13.20.15 = 2.12991919321879e-06, i13.20.16 = 2.77601037337378e-05,
            i14.1 = 7.92964523758077e-05, i14.2 = 8.50682273375204e-05, i14.3 = 2.4972271586306e-05,
            i15.a = 0.00013777473136041, i15.b = 0.000128329115589074, i15.c = 6.85128784053385e-05,
            i15.d = 5.34843781261688e-05, i15.e = 6.50933810252117e-05, i15.f = 9.42022414023149e-05,
            i15.g = 1.62898201270225e-05, i15.h = 0.000159707289305438, i15.i = 0.000312745542104043,
            i15.j = 0.000128149247393907, i15.k = 2.13455445961519e-05, i16 = 0.00011055222469986,
            i17 = 0.000134876178864435, i18 = 3.94674720322751e-05, i19 = 3.16957609171663e-05,
            i20 = 0.000209235364861637, i20.w = 3.94340106407669e-05, i21.1 = 3.88004506729672e-05,
            i21.2 = 0.000101708166997599, i21.w.1 = 0.000218414279486893,
            i22 = 0.000232407432580732, i23.1 = 7.28462245755726e-06, i23.2 = 0.000111052660459376,
            i23.3 = 2.62750456767119e-06, i24.a = 0.000338940335480691, i24.a.w = 3.92169921652562e-05,
            i24.b = 1.56323679774242e-06, i24.c = 2.8713433197702e-06, i24.d = 0.000277658015448696,
            i25 = 0.000691726671752867, i26.a = 5.42899051362085e-05, i26.a.w = 0.000209423172178174,
            i26.b = 6.73619179895966e-05, i26.c = 3.34072028514122e-05, i26.d = 0.000162041003500179,
            i26.e = 8.95682785491156e-05, i27.41 = 6.14792568183845e-06,
            i27.42 = 1.80577539095921e-05, i27.42.w = 3.44263854482228e-05,
            i27.43 = 6.76266027023716e-06, i27.43.w = 1.12648559237593e-05,
            i27.44 = 4.81303668490852e-05, i27.44.w = 3.93544687028008e-06,
            i27.45 = 6.95893852364278e-06, i27.5 = 5.48876748756771e-05,
            i27.a = 0.000189921924047182, i27.a.w = 7.74701610011017e-05,
            i28 = 0.00036331743921992, i29 = 0.00131852899726886, i30 = 3.22207609403346e-05,
            i31 = 0.00208829220282266, i32 = 0.000147076969304068, i33 = 0.000299639188894654,
            i34 = 0.00282700109963942, i35 = 0.00012361339411265, i36 = 0.000716922672072634,
            i37 = 0.000674023654156166, i40.11.a = 0.000172307235871185,
            i40.11.b = 6.3202432188539e-05, i40.11.c = 6.32292679225657e-05,
            i40.11.d = 1.0965034765585e-05, i40.11.e = 2.46818248003897e-05,
            i40.11.f = 8.79816574363907e-06, i40.11.g = 3.43923070014095e-05,
            i40.11.h = 1.45024977606317e-05, i40.11.k = 6.138477486969e-06,
            i40.11.l = 1.20002087969552e-05, i40.12 = 7.05204719403653e-05,
            i40.13 = 0.000245284372795764, i40.2 = 0.000286855791875371,
            i40.3 = 8.38619123249047e-06, i41 = 0.000138154189398789, i45 = 0.0163383854548682,
            i45.w = 0.000286822521278109, i50.a = 0.00135025721828708, i51 = 0.010546330853788,
            i52 = 0.00683540893067304, i55 = 0.000916710775220067, i60.1 = 0.00384125758386332,
            i60.2 = 0.0189746131197387, i60.3 = 0.000647592461265386, i61.1 = 0.00894927025602909,
            i61.2 = 0.00222210830164681, i62 = 0.000622455184493284, i63 = 0.0142814214880705,
            i64 = 0.00639666024414061, i65 = 5.68277302253875e-05, i66 = 0.000250826715370846,
            i67 = 0.000102715358605068, i70 = 0.000516184158629778, i71 = 6.10043116008578e-06,
            i72 = 0.000239228693386086, i73 = 0.000109549254575422, i74 = 0.00791670076761752,
            i75 = 0.00739829783490429, i80 = 6.15578648466802e-05, i85 = 0.00415792589480702,
            i90.1.a = 0.000253682429714183, i90.1.b = 0.000364622270223385,
            i90.1.c = 0.000361858622544386, i90.1.d = 0.000438175047867159,
            i90.1.e = 5.86309950429975e-05, i90.1.f = 0.000219147385661292,
            i90.1.g = 0.000350845127351327, i90.2.a = 6.6321925604366e-05,
            i90.2.b = 5.70127407984742e-06, i90.2.c = 0.000370332539464665,
            i90.3.a = 0.000193501438097638, i90.3.b = 4.87080860898838e-07,
            i90.4.a = 9.28204064457791e-05, i90.4.b = 0.000178128148103167,
            i90.5.a = 4.64072120859417e-06, i90.5.b = 1.06407071760783e-05,
            i90.5.c = 7.66299647280079e-06, i90.5.d = 8.86821420665267e-05,
            i90.5.e = 2.18378060548311e-06, i90.5.f = 5.36493575680133e-06,
            i91 = 0.00317749810599014, i92 = 0.000331553195236209, i93 = 0.00445470910256129,
            y01 = 0.851856084568139)


test_that("finding maxent gamma works", {
  expect_no_error(find_gamma_maxent(shares, eval_f = dirichlet_entropy, shares_lb = 1E-3))
  expect_error(find_gamma_maxent(c(0.1, 0.4, 0.2), eval_f = dirichlet_entropy))
})
